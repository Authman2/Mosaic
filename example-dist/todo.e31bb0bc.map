{"version":3,"sources":["../../src/vdom/createElement.js","../../src/util.js","../../src/vdom/render.js","../../src/vdom/patch.js","../../src/observable.js","../../src/router.js","../../src/validations.js","../../src/index.js","index.js"],"names":["createElement","type","props","children","exports","setAttributes","$element","key","value","instance","startsWith","event","slice","toLowerCase","__mosaicHandlers","removeEventListener","addEventListener","Object","assign","style","__mosaicKey","setAttribute","traverseVDomTree","head","start","array","comparator","action","push","i","cloneFunction","that","f","apply","arguments","hasOwnProperty","deepClone","from","out","create","call","bind","isHTMLElement","obj","HTMLElement","e","nodeType","ownerDocument","viewToDOM","input","caller","replaced","dataProp","data","propName","propVal","re","RegExp","nstring","replace","parser","DOMParser","parseFromString","body","firstChild","render","vnode","$parent","mount","$el","replaceWith","appendChild","$e","document","createTextNode","__isMosaic","Mosaic","view","$dom","concat","child","prop","Error","patch","parentNode","replaceChild","Text","textContent","$node","element","nodeName","toUpperCase","n","pool","active","activeElement","childNodes","map","index","__mosaicInstance","willDestroy","remove","attr","attributes","removeAttribute","name","focus","Observable","observingObject","willChange","didChange","Handler","get","object","receiver","Reflect","set","old","defineProperty","descriptor","deleteProperty","Proxy","Router","routes","invalid","find","r","Array","isArray","path","includes","undefined","currentRoute","mosaic","mosaicRouter","send","to","routeObj","window","history","pushState","location","origin","paint","back","forward","onpopstate","oldURL","pathname","oldRouteObj","prototype","href","substring","lastIndexOf","findInvalidOptions","options","contains","actions","created","willUpdate","updated","willDestory","MosaicOptions","Function","invalids","_tempData","htree","oldData","destroy","removeChild","link","_data","parent","length","constructor","$ndom","h","TodoItem","deleteTodo","title","todoApp","getElementById","todos","addTodo","todoIndex","splice","keyCode","todo"],"mappings":"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","file":"todo.e31bb0bc.map","sourceRoot":"../examples/todo","sourcesContent":["const createElement = function(type, props = {}, ...children) {\n    return {\n        type: type,\n        props: props || {},\n        children,\n    };\n}\nexports.createElement = createElement;","/** Sets the attributes on the HTML elements that were mounted by the virtual DOM. */\nconst setAttributes = function($element, key, value, instance = null) {\n    // 1.) Function handler for dom element.\n    if(typeof value === 'function' && key.startsWith('on')) {\n        const event = key.slice(2).toLowerCase();\n        $element.__mosaicHandlers = $element.__mosaicHandlers || {};\n        $element.removeEventListener(event, $element.__mosaicHandlers[event]);\n        \n        $element.__mosaicHandlers[event] = value;\n        $element.addEventListener(event, $element.__mosaicHandlers[event]);\n    }\n    // 2.) Particular types of attributes.\n    else if(key === 'checked' || key === 'value' || key === 'className') {\n        $element[key] = value;\n    }\n    // 3.) Style property.\n    else if(key === 'style') {\n        if(typeof value === 'object') Object.assign($element.style, value);\n        else if(typeof value === 'string') $element[key] = value;\n    }\n    // 5.) Support the key property for more efficient rendering.\n    else if(key === 'key') {\n        $element.__mosaicKey = value;\n    }\n    // 6.) Value is a not an object nor a function, so anything else basically.\n    else if(typeof value !== 'object' && typeof value !== 'function') {\n        $element.setAttribute(key, value);\n    }\n}\n\n/** Start with a particular VNode and traverse the entire tree and only return the ones that match\n* the comparator.\n* @param {Object} head The absolute parent VNode.\n* @param {Object} start The starting VNode.\n* @param {Array} array The final array to return.\n* @param {Function} comparator The compare function. \n* @param {Function} action The action to take when the comparator is true. */\nconst traverseVDomTree = function(head, start, array, comparator, action) {\n\t// console.log(\"DOM: \", start);\n\tif(comparator(head, start, array) === true) {\n\t\tif(action) action(head, start, array);\n\t\tarray.push(start);\n\t}\n\n\tfor(var i in start.children) {\n\t\ttraverseVDomTree(head, start.children[i], array, comparator, action);\n\t}\n\treturn array;\n}\n\n/** Clones a function. */\nconst cloneFunction = function() {\n    var that = this;\n    var f = function() { return that.apply(this, arguments); };\n    for(var key in this) {\n        if (this.hasOwnProperty(key)) {\n            f[key] = this[key];\n        }\n    }\n    return f;\n};\n\n/** Does a deep clone of an object, also cloning its children.\n * @param {Object} from The input object to copy from.\n */\nconst deepClone = function(from) {\n\tlet out = Object.create({});\n\tif(typeof from === 'function') {\n\t\treturn cloneFunction.call(from);\n\t}\n\tfor(var i in from) {\n\t\tif(from.hasOwnProperty(i)) {\n\t\t\tif(typeof from[i] === 'object') {\n\t\t\t\t// if(from[i].__IS_PROXY) {\n\t\t\t\t// \tlet ulo = Object.assign({}, from[i].__TARGET);\n\t\t\t\t// \tlet nProx = new Observable(ulo, () => from[i].willChange, () => from[i].didChange);\n\t\t\t\t// \tout[i] = nProx;\n\t\t\t\t// } else {\n\t\t\t\t\tout[i] = Object.assign({}, deepClone(from[i]));\n\t\t\t\t// }\n\t\t\t}\n\t\t\telse if(typeof from[i] === 'function') {\n\t\t\t\tout[i] = from[i].bind(out);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tout[i] = from[i];\n\t\t\t}\n\t\t}\n\t}\n\treturn out;\n}\n\n/** Returns whether or not an object is an HTML element. */\nfunction isHTMLElement(obj) {\n    try { return obj instanceof HTMLElement; }\n    catch(e){\n      return (typeof obj === \"object\") && (obj.nodeType === 1) && (typeof obj.style === \"object\") &&\n        (typeof obj.ownerDocument ===\"object\");\n    }\n}\n\n/** Converts an html string into actual DOM elements. If the view function is passed in, it will\n* just be returned.\n* @param {String} input The HTML string. */\nconst viewToDOM = function(input, caller) {\n    if(typeof input === 'function') return input.call(caller);\n\n    var replaced = input;\n    for(var dataProp in caller.data) {\n        let propName = dataProp;\n        let propVal = caller.data[dataProp];\n        let re = new RegExp('{{[ ]*this.data.' + propName + '[ ]*}}', \"gim\");\n        let nstring = input.replace(re, propVal);\n        replaced = nstring;\n    }\n    let parser = new DOMParser();\n    let $element = parser.parseFromString(replaced, 'text/html').body.firstChild;\n    return $element;\n}\n\nexports.setAttributes = setAttributes;\nexports.traverseVDomTree = traverseVDomTree;\nexports.deepClone = deepClone;\nexports.isHTMLElement = isHTMLElement;\nexports.viewToDOM = viewToDOM;","import { Mosaic } from '../index';\nimport { setAttributes, isHTMLElement } from '../util';\n\nconst render = function(vnode, $parent = null, instance = null, replace = false) {\n    const mount = $parent ? ($el => (replace ? $parent.replaceWith($el) : $parent.appendChild($el))) : ($el => $el);\n\n    // 1.) Primitive types.\n    if(typeof vnode === 'string' || typeof vnode === 'number') {\n        let $e = document.createTextNode(typeof vnode === 'boolean' ? '' : vnode);\n        return mount($e);\n    }\n    // 2.) A Mosaic component.\n    else if(typeof vnode === 'object' && typeof vnode.type === 'object' && vnode.type.__isMosaic === true) {\n        return Mosaic.view(vnode, $parent);\n    }\n    // 3.) If it is already a dom element, just return it!\n    else if(isHTMLElement(vnode)) {\n        return mount(vnode);\n    }\n    // 4.) Handle child components and attributes.\n    else if(typeof vnode === 'object' && typeof vnode.type === 'string') {\n        const $e = document.createElement(vnode.type);\n        const $dom = mount($e);\n        for(var child of [].concat(...vnode.children)) render(child, $dom, instance);\n        for(var prop in vnode.props) setAttributes($dom, prop, vnode.props[prop], instance);\n        return $dom;\n    }\n    // 5.) Otherwise, throw an error.\n    else {\n        throw new Error(`Invalid Virtual DOM Node: ${vnode}.`);\n    }\n}\nexports.render = render;","import { Mosaic } from '../index';\nimport { render } from './render';\nimport { setAttributes, isHTMLElement, viewToDOM } from '../util';\n\nconst patch = function($dom, vnode, $parent = $dom.parentNode, instance = null) {\n    const replace = $parent ? ($el => { $parent.replaceChild($el, $dom); return $el }) : ($el => $el);\n    // console.log($dom, vnode);\n\n    // 1.) Patch the differences of a Mosaic type.\n    if(typeof vnode === 'object' && typeof vnode.type === 'object' && vnode.type.__isMosaic === true) {\n        return Mosaic.patch($dom, vnode, $parent);\n    }\n    // 2.) Compare plain text nodes.\n    else if(typeof vnode !== 'object' && $dom instanceof Text) {\n        return ($dom.textContent !== vnode) ? replace(render(vnode, $parent, instance)) : $dom;\n    }\n    // 3.) If it is an HTML element, just replace the dom element.\n    else if(isHTMLElement(vnode)) {\n        let $node = replace(vnode);\n        instance.element = $node;\n        return $node;\n    }\n    // 4.) If one is an object and one is text, just replace completely.\n    else if(typeof vnode === 'object' && $dom instanceof Text) {\n        return replace(render(vnode, $parent, instance));\n    }\n    // 5.) One is an object and the tags are different, so replace completely.\n    else if(typeof vnode === 'object' && (vnode.type && !vnode.type.__isMosaic) && $dom.nodeName !== vnode.type.toUpperCase()) {\n        let n = replace(render(vnode, $parent, instance));\n        return n;\n    }\n    // 6.) If they are objects and their tags are equal, patch their children recursively.\n    else if(typeof vnode === 'object' && $dom.nodeName === vnode.type.toUpperCase()) {\n        const pool = {};\n        const active = document.activeElement;\n\n        [].concat(...$dom.childNodes).map((child, index) => {\n            const key = child.__mosaicKey || `__index_${index}`;\n            pool[key] = child;\n        });\n        [].concat(...vnode.children).map((child, index) => {\n            const key = child.props && child.props.key || `__index_${index}`;\n            var $node;\n\n            if(pool[key]) $node = patch(pool[key], child)\n            else $node = render(child, $dom, instance);\n\n            $dom.appendChild($node);\n            delete pool[key];\n        });\n\n        // Unmount the component and call the lifecycle function.\n        for(const key in pool) {\n            const instance = pool[key].__mosaicInstance;\n            if(instance && instance.willDestroy) instance.willDestroy();\n            pool[key].remove();\n        }\n\n        // Remove and reset the necessary attributes.\n        for(var attr in $dom.attributes) $dom.removeAttribute(attr.name);\n        for(var prop in vnode.props) setAttributes($dom, prop, vnode.props[prop], vnode);\n        active.focus();\n        \n        // Return the real dom node.\n        return $dom;\n    }\n}\n\nexports.patch = patch;","/** Basically an object that can perform a certain function when a property changes. \n* @param {Object} observingObject The object to look for changes in.. */\nconst Observable = function(observingObject, willChange, didChange) {\n    const Handler = {\n        get(object, name, receiver) {\n            if(name === '__TARGET') { return Object.assign({}, observingObject); };\n            if(name === '__IS_PROXY') { return true };\n\n            return Reflect.get(object, name, receiver);\n        },\n        set(object, name, value) {\n            // About to update.\n            let old = Object.assign({}, observingObject);\n            if(willChange) willChange(old);\n            \n            // Make changes.\n            object[name] = value;\n            \n            // Did update.\n            if(didChange) didChange(object);\n\n            return Reflect.set(object, name, value);\n        },\n        defineProperty(object, name, descriptor) {\n            didChange(object);\n            return Reflect.defineProperty(object, name, descriptor);\n        },\n        deleteProperty(object, name) {\n            didChange(object);\n            return Reflect.deleteProperty(object, name);\n        }\n    };\n    return new Proxy(observingObject, Handler);\n}\n\nexports.Observable = Observable;","/** A basic routing solution for Mosaic apps.\n* @param {Array} routes A list of routes of the form { path: String | Array of Strings, mosaic: Mosaic }. */\nconst Router = function(...routes) {\n    // Make sure there is at least one default route.\n    let invalid = routes.find(r => {\n        if(!('path' in r) || !('mosaic' in r)) return false;\n        if(Array.isArray(r.path)) return r.path.includes('/');\n        else return r.path === '/';\n    })\n    if(invalid === undefined) {\n        throw new Error(`Mosaic.Router requires a \"path\" proeprty and a \"mosaic\" property for each route. There \n        must be exactly one default route with the path of \\'/\\'`);\n    }\n\n\n    // Get the default route, which should be the empty path.\n    this.currentRoute = routes.find(r => {\n        if(Array.isArray(r.path)) return r.path.includes('/');\n        else return r.path === '/';\n    }).path || '/';\n    if(Array.isArray(this.currentRoute)) this.currentRoute = '/';\n\n\n    // Link all of the components to this router, so they can be passed down to children.\n    for(var i in routes) {\n        routes[i].mosaic.mosaicRouter = this;\n    }\n\n    /** Function to send the app to a different route.\n    * @param {String} to The path to point the router to. Must already exist in the router at initialization. */\n    this.send = function(to) {\n        this.currentRoute = to;\n        let routeObj = routes.find(r => {\n            if(Array.isArray(r.path)) return r.path.includes(to);\n            else return r.path === to;\n        });\n\n        if(routeObj) {\n            window.history.pushState({}, this.currentRoute, window.location.origin + this.currentRoute);\n            routeObj.mosaic.paint();\n        } else {\n            throw new Error(`There was no route defined for ${this.currentRoute}`);\n        }\n    }\n\n    /** A function to send this router back one page. */\n    this.back = function() {\n        window.history.back();\n    }\n\n    /** A function to send this router forward one page. */\n    this.back = function() {\n        window.history.forward();\n    }\n\n    // Setup the 'pop' url state.\n    window.onpopstate = function() {\n        let oldURL = window.location.pathname;\n        let oldRouteObj = routes.find(r => {\n            if(Array.isArray(r.path)) return r.path.includes(oldURL);\n            else return r.path === oldURL;\n        });\n        oldRouteObj.mosaic.paint();\n    }\n}\n\n/** The paint function for the Mosaic Router. Performs the same function as the paint function for Mosaic\n* components, but handles painting all components labeled as routes. */\nRouter.prototype.paint = function() {\n    let path = this.currentRoute;\n\n    // If the current url at run time is different than what it was set to, change it.\n    if(window.location.origin !== path) {\n        this.currentRoute = window.location.href.substring(window.location.href.lastIndexOf('/'));\n    }\n    \n    this.send(this.currentRoute);\n}\n\n\nexports.Router = Router;","import { isHTMLElement } from './util';\n\n/** Looks at a Mosaic's configuration options and returns undefined if there is nothing wrong, and\n * returns a descriptor sentence if something is wrong.\n * @param {MosaicOptions} options The config options.\n * @returns {undefined} If there is nothing wrong with the input options.\n * @returns {String} describing the problem.\n */\nconst findInvalidOptions = function(options) {\n    // Element\n    if(options.element && (!isHTMLElement(options.element) || !document.contains(options.element))) {\n        return `The Mosaic could not be created because the \"element\" property is either not an HTML DOM \n        element or it does not already exist in the DOM. Make sure that the \"element\" property is an already \n        existing DOM element such as \"document.body\" or a div with the id of 'root' for example.`;\n    }\n\n    // Data\n    if(options.data && typeof options.data !== 'object') {\n        return `The data property of a Mosaic must be defined as a plain, JavaScript object.`;\n    }\n\n    // View\n    if(!options.view) {\n        return `View is a required property of Mosaic components.`\n    }\n    if(typeof options.view !== 'function' && typeof options.view !== 'string') {\n        return `The view property must either be a function that returns JSX code, an h-tree, a string representation\n        of an HTML tree, or the path to an HTML file.`;\n    }\n\n    // Actions\n    if(options.actions && typeof options.actions !== 'object') {\n        return `Actions must be defined as an object, where each entry is a function.`;\n    }\n\n    // Lifecycle\n    if((options.created && typeof options.created !== 'function')) {\n        return `All lifecycle methods (created, willUpdate, updated, and willDestroy) must be\n        function types.`;\n    }\n    if(options.willUpdate && typeof options.willUpdate !== 'function') {\n        return `All lifecycle methods (created, willUpdate, updated, and willDestroy) must be\n        function types.`;\n    }\n    if(options.updated && typeof options.updated !== 'function') {\n        return `All lifecycle methods (created, willUpdate, updated, and willDestroy) must be\n        function types.`;\n    }\n    if(options.willDestory && typeof options.willDestory !== 'function') {\n        return `All lifecycle methods (created, willUpdate, updated, and willDestroy) must be\n        function types.`;\n    }\n\n    return undefined;\n}\n\nexports.isHTMLElement = isHTMLElement;\nexports.findInvalidOptions = findInvalidOptions;","import { createElement } from './vdom/createElement';\nimport { render } from './vdom/render';\nimport { patch } from './vdom/patch';\nimport { Observable } from './observable';\nimport { Router } from './router';\nimport { isHTMLElement, findInvalidOptions } from './validations';\nimport { viewToDOM } from './util';\n\n/** The configuration options for a Mosaic component. */\nconst MosaicOptions = {\n    /** The HTML element to inject this Mosaic component into. */\n    element: HTMLElement,\n\n    /** The state of this component. */\n    data: Object,\n\n    /** The view that will be rendered on the screen. */\n    view: Function,\n\n    /** The actions that can be used on this Mosaic component. */\n    actions: Object,\n\n    /** The function to run when this component is created and injected into the DOM. */\n    created: Function,\n\n    /** The function to run when this component is about to update its data. */\n    willUpdate: Function,\n\n    /** The function to run after this component has been updated. */\n    updated: Function,\n\n    /** The function that runs just before this component gets removed from the DOM. */\n    willDestroy: Function\n};\n\n\n/** Creates a new Mosaic component with configuration options.\n* @param {MosaicOptions} options The configuration options for this Mosaic. */\nconst Mosaic = function(options) {\n    let invalids = findInvalidOptions(options);\n    if(invalids !== undefined) throw new Error(invalids);\n\n    this.element = options.element\n    this.view = options.view;\n    this.created = options.created;\n    this.willUpdate = options.willUpdate;\n    this.updated = options.updated;\n    this.willDestroy = options.willDestroy;\n\n    // Make each array a proxy of its own so that \n    let _tempData = options.data;\n    for(var i in _tempData) {\n        if(!Array.isArray(_tempData[i])) continue;\n        \n        _tempData[i] = new Observable(_tempData[i], () => {}, () => {\n            let htree = viewToDOM(this.view, this);\n            patch(this.element, htree, this.element.parentNode, this);\n            if(this.updated) this.updated();\n        });\n    }\n    // Setup the data observer.\n    this.data = new Observable(_tempData || {}, (oldData) => {\n        if(this.willUpdate) this.willUpdate(oldData);\n    }, () => {\n        let htree = viewToDOM(this.view, this);\n        patch(this.element, htree, this.element.parentNode, this);\n        if(this.updated) this.updated();\n    });\n\n    this.actions = options.actions;\n    this.__isMosaic = true;\n\n    // Bind actions.\n    for(var i in this.actions) this.actions[i] = this.actions[i].bind(this);\n\n    \n    /** Destroys this instance of the Mosaic and triggers the willDestory lifecycle function. */\n    this.destroy = function() {\n        const instance = this.element.__mosaicInstance;\n        if(instance && instance.willDestroy) instance.willDestroy();\n        this.element.remove();\n    }\n\n    return this;\n}\n\n/** \"Paints\" the Mosaic onto the page by injecting it into its base element. */\nMosaic.prototype.paint = function() {\n    if(!this.element || !isHTMLElement(this.element)) {\n        throw new Error(`This Mosaic could not be painted because its element property is either not set\n        or is not a valid HTML element.`);\n    }\n    \n    // Clear anything that is there.\n    while(this.element.firstChild) this.element.removeChild(this.element.firstChild);\n\n    // Render an h-tree.\n    let htree = createElement(this);\n    render(htree, this.element, this);\n}\n\n\n/** A basic routing solution for Mosaic apps.\n* @param {Array} routes A list of routes of the form { path: String | Array of Strings, mosaic: Mosaic }. */\nMosaic.Router = Router;\n\n\n\n\n/** Static function for building a new instance of a Mosaic. Basically just takes a given VNode of a Mosaic\n * and uses it as a blueprint for how to build reusable instances of that component.\n */\nMosaic.view = function(vnode, $parent = null) {\n    let props = Object.assign({}, vnode.props);\n    \n    // Link is an optional relationship that can be added to each component.\n    let link = props.link ? props.link : undefined;\n    if('link' in props) delete props['link'];\n\n    const _data = Object.assign({}, vnode.type.data, props);\n    \n    // Render a new instance of this component.\n    if(typeof vnode.type === 'object' && vnode.type.__isMosaic) {\n        const options = {\n            element: vnode.type.element,\n            data: _data,\n            view: vnode.type.view,\n            actions: Object.assign({}, vnode.type.actions),\n            created: vnode.type.created,\n            willUpdate: vnode.type.willUpdate,\n            updated: vnode.type.updated,\n            willDestroy: vnode.type.willDestroy,\n        }\n        const instance = new Mosaic(options);\n        if(typeof link !== 'undefined') {\n            instance.parent = link.parent;\n            link.parent[link.name] = instance;\n        }\n        if(vnode.children && vnode.children.length > 0) {\n            instance.children = vnode.children;\n        }\n        let htree = viewToDOM(instance.view, instance);\n        instance.element = render(htree, $parent, instance);\n        instance.element.__mosaicInstance = instance;\n        instance.element.__mosaicKey = vnode.props.key;\n\n        if(instance.created) instance.created();\n        return instance.element;\n    } else {\n        let htree = viewToDOM(vnode.type.view, vnode);\n        return render(htree, $parent);\n    }\n}\n\n/** Static function for diffing and patching changes between instances of Mosaics. */\nMosaic.patch = function($dom, vnode, $parent = $dom.parentNode) {\n    const props = Object.assign({}, vnode.props, { children: vnode.children });\n    \n    if($dom.__mosaicInstance && $dom.__mosaicInstance.constructor === vnode.type) {\n        $dom.__mosaicInstance.props = props;\n        let htree = viewToDOM($dom.__mosaicInstance.view, $dom.__mosaicInstance);\n        return patch($dom, htree, $parent, $dom.__mosaicInstance);\n    }\n    else if(typeof vnode.type === 'object' && vnode.type.__isMosaic === true) {\n        const $ndom = Mosaic.view(vnode, $parent);\n        return $parent ? ($parent.replaceChild($ndom, $dom) && $ndom) : $ndom;\n    }\n    else if(typeof vnode.type !== 'object' || vnode.type.__isMosaic === false) {\n        let htree = viewToDOM(vnode.type.view.bind(props), vnode.type);\n        return patch($dom, htree, $parent, $dom.__mosaicInstance);\n    }\n}\n\nwindow.h = createElement;\nwindow.Mosaic = Mosaic;\nexports.h = createElement;\nexports.Mosaic = Mosaic;","import { Mosaic } from '../../src/index';\n\n/* Example of a Todo application using Mosaic. */\nconst TodoItem = new Mosaic({\n    view: function() {\n        return <div class='todo-item' onclick={this.data.deleteTodo}>\n            { this.data.title || '' }\n        </div>\n    }\n});\n\nconst todoApp = new Mosaic({\n    element: document.getElementById('root'),\n    data: {\n        todos: ['Click the \"Add Todo\" button to add another todo item!',\n                'Click on a todo item to delete it.']\n    },\n    actions: {\n        addTodo: function() {\n            let value = document.getElementById('inp').value;\n            document.getElementById('inp').value = '';\n\n            this.data.todos.push(value);\n        },\n        deleteTodo: function(todoIndex) {\n            this.data.todos.splice(todoIndex, 1);\n        }\n    },\n    view: function() {\n        return <div class='app'>\n            <h1 class='app-title'>Mosaic Todo List</h1>\n            <input id='inp' type='text' placeholder='Enter your todo item'\n                    onkeypress={(e) => { if(e.keyCode === 13) this.actions.addTodo() }}/>\n                    \n            <button onclick={this.actions.addTodo}>Add Todo</button>\n\n            {\n                this.data.todos.map((todo, index) => {\n                    return <TodoItem title={todo}\n                                    deleteTodo={this.actions.deleteTodo.bind(this, index)}/>\n                })\n            }\n        </div>\n    }\n});\ntodoApp.paint();"]}